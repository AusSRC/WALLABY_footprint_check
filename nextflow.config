resume = true

profiles {
    magnus {
        workDir = '/group/ja3/wallaby/runs/work/'
        tmpDir = '/group/ja3/wallaby/tmp/'

        process {
            cache = 'lenient'
            stageInMode = 'symlink'
        }

        process {
            executor = 'slurm'
            queue = 'workq'
            module = 'singularity'
            clusterOptions = '--nodes=1 --account=ja3 --time=24:00:00'
        }

        params {
            WORKDIR = "/group/ja3/wallaby/preprocessing/"
            SCRATCH_ROOT = "/group/ja3/wallaby/"
            ASTROPY_CACHEDIR = "/group/ja3/ashen/"
            DOWNLOAD_QUERY = 'SELECT * FROM ivoa.obscore WHERE obs_id IN ($SBIDS) AND (filename LIKE "weights.i.%.cube.fits" OR filename LIKE "image.restored.i.%.cube.contsub.fits")'

            WALLABY_COMPONENTS_IMAGE = "aussrc/wallaby_scripts:latest"
            CASDA_DOWNLOAD_COMPONENTS_IMAGE = "aussrc/casda_download_components:v0.0.3"
            SOURCE_FINDING_COMPONENTS_IMAGE = "aussrc/source_finding_components:latest"
            S2P_IMAGE = "aussrc/s2p_setup:v0.1.6"
            SOFIA_IMAGE = "docker://astroaustin/sofia:v0.0.1c"
            WALLMERGE_IMAGE = "aussrc/wallmerge:v0.0.1"
            SINGULARITY_CACHEDIR = "/group/ja3/WALLABY/apps/singularity"
        }

        singularity {
            enabled = true
            cacheDir = '/group/ja3/WALLABY/apps/singularity'
            envWhitelist = 'SINGULARITY_BINDPATH, SINGULARITYENV_LD_LIBRARY_PATH'
        }

        docker.enabled = false
    }

    carnaby {
        docker.enabled = false
    }
}
