resume = true

profiles {
    magnus {
        workDir = '/group/ja3/wallaby/runs/work/'
        tmpDir = '/group/ja3/wallaby/tmp/'

        process {
            cache = 'lenient'
            stageInMode = 'symlink'
        }

        process {
            executor = 'slurm'
            queue = 'workq'
            module = 'singularity'
            clusterOptions = '--nodes=1 --account=ja3 --time=24:00:00'
        }

        params {
            WORKDIR = "/group/ja3/wallaby/preprocessing"
            SCRATCH_ROOT = "/group/ja3/wallaby/"
            ASTROPY_CACHEDIR = "/group/ja3/ashen/"
            SINGULARITY_CACHEDIR = "/group/ja3/WALLABY/apps/singularity"            
        }

        singularity {
            enabled = true
            cacheDir = '/group/ja3/WALLABY/apps/singularity'
            envWhitelist = 'SINGULARITY_BINDPATH, SINGULARITYENV_LD_LIBRARY_PATH'
        }

        docker.enabled = false
    }

    carnaby {
        process {
            executor = 'slurm'
            queue = 'cpu'
        }

        params {
            WORKDIR = "/mnt/shared/wallaby/pre-runs"
            SOFIA_PARAMETER_FILE = "/mnt/shared/wallaby/config/sofia.par"
            S2P_TEMPLATE = "/mnt/shared/wallaby/config/s2p_setup.ini"
            SCRATCH_ROOT = "/mnt/shared"
            SINGULARITY_CACHEDIR = "/mnt/shared/wallaby/apps/singularity"
        }

        singularity {
            enabled = true
            cacheDir = "/mnt/shared/wallaby/apps/singularity/"
        }

        docker.enabled = false
    }
}

params {
    OUTPUT_DIR = "output"
    WALLMERGE_OUTPUT = "mom0.fits"
    WALLABY_COMPONENTS_IMAGE = "docker://aussrc/wallaby_scripts:latest"
    SOURCE_FINDING_COMPONENTS_IMAGE = "docker://aussrc/source_finding_components:latest"
    S2P_IMAGE = "docker://aussrc/s2p_setup:v0.1.6"
    SOFIA_IMAGE = "docker://astroaustin/sofia:v0.0.1c"
    WALLMERGE_IMAGE = "aussrc/wallmerge:v0.0.1"
}